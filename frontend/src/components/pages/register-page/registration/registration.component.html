<div [formGroup]="form" 
*ngIf="(lngService.dictionary$ | async) as $">

  <mat-vertical-stepper linear
  *ngIf="{errors: $.errors, form: $.pages.registration.form} as $">

    <mat-step [label]="$.form.steps.BASE" [stepControl]="form.get('base')">
      <form formGroupName="base" *ngIf="form.get('base') as base">
        <mat-grid-list cols="1" rowHeight="6rem">
          <mat-grid-tile>
            <mat-form-field *ngIf="base.get('email') as email">
              <mat-label>{{ $.form.inputs.EMAIL }}</mat-label>
              <input 
              id="email"
              type="email" 
              matInput 
              placeholder="example@mail.com" 
              [formControl]="email" required>

              <mat-icon>email</mat-icon>

              <mat-error *ngIf="email.hasError('required')">
                {{ $.errors.inputs.general.REQUIRED }}
              </mat-error>
              <mat-error *ngIf="email.hasError('pattern')">
                {{ $.errors.inputs.email.INVALID }}
              </mat-error>
              <mat-error *ngIf="email.hasError('server-error')">
                {{ this.serverInputsErrors['base.email'] }}
              </mat-error>
            </mat-form-field>
          </mat-grid-tile>

          <mat-grid-tile>
            <mat-form-field *ngIf="base.get('password') as password">
              <mat-label>{{ $.form.inputs.PASSWORD }}</mat-label>
              <input 
              id="password"
              type="password"
              matInput 
              [formControl]="password" required>
              <mat-icon>vpn_key</mat-icon>
              
              <mat-error *ngIf="password.hasError('required')">
                {{ $.errors.inputs.general.REQUIRED }}
              </mat-error>
              <mat-error *ngIf="password.hasError('minLength')">
                {{ $.errors.inputs.password.MIN_LENGTH }}
              </mat-error>
              <mat-error *ngIf="password.hasError('maxLength')">
                {{ $.errors.inputs.password.MAX_LENGTH }}
              </mat-error>
              <mat-error *ngIf="password.hasError('server-error')">
                {{ this.serverInputsErrors['base.password'] }}
              </mat-error>
            </mat-form-field>
          </mat-grid-tile>

          <mat-grid-tile>
            <mat-form-field *ngIf="base.get('repeatPassword') as passwordRepeat">
            <mat-label>{{ $.form.inputs.REPEAT_PASSWORD }}</mat-label>
            <input 
            id="repeatPassword"
            type="password"
            matInput 
            [formControl]="passwordRepeat" required
            [errorStateMatcher]="errorStateMatcher.repeatPassword">
            <mat-icon>vpn_key</mat-icon>
            
            <mat-error *ngIf="passwordRepeat.hasError('required')">
              {{ $.errors.inputs.general.REQUIRED }}
            </mat-error>
            <mat-error *ngIf="passwordRepeat.hasError('not-equals')">
              {{ $.errors.inputs.repeatPassword.NOT_EQUALS }}
            </mat-error>
            </mat-form-field>
          </mat-grid-tile>
        
        </mat-grid-list>

        <div>
          <button mat-button (click)="onCancel.emit()" class="cancelButton">{{ $.form.controls.CANCEL }}</button>
          <button mat-button matStepperNext class="nextButton">{{ $.form.controls.NEXT }}</button>
        </div>
      </form>
    </mat-step>

    <mat-step [label]="$.form.steps.PERSONAL" [stepControl]="form.get('personal')">
      <form formGroupName="personal" *ngIf="form.get('personal') as personal">
        <mat-grid-list cols="1" rowHeight="6rem">
          <mat-grid-tile>
            <mat-form-field *ngIf="personal.get('name') as name">
              <mat-label>{{ $.form.inputs.NAME }}</mat-label>
              <input 
              id="name"
              type="text" 
              matInput 
              placeholder="Jan" 
              [formControl]="name" required>
              
              <mat-error *ngIf="name.hasError('required')">
                {{ $.errors.inputs.general.REQUIRED }}
              </mat-error>
              <mat-error *ngIf="name.hasError('server-error')">
                {{ this.serverInputsErrors['personal.name'] }}
              </mat-error>
            </mat-form-field>
          </mat-grid-tile>

          <mat-grid-tile>
            <mat-form-field *ngIf="personal.get('lastname') as lastname">
              <mat-label>{{ $.form.inputs.LASTNAME }}</mat-label>
              <input 
              id="lastname"
              type="text" 
              matInput 
              placeholder="Kowalski" 
              [formControl]="lastname" required>
              
              <mat-error *ngIf="lastname.hasError('required')">
                {{ $.errors.inputs.general.REQUIRED }}
              </mat-error>
              <mat-error *ngIf="lastname.hasError('server-error')">
                {{ this.serverInputsErrors['personal.lastname'] }}
              </mat-error>
            </mat-form-field>
          </mat-grid-tile>

          <mat-grid-tile>
            <mat-form-field *ngIf="personal.get('dateBirth') as dateBirth">
              <mat-label>{{ $.form.inputs.DATE_BIRTH }}</mat-label>
              <input 
              id="dateBirth" 
              matInput 
              [matDatepicker]="picker" 
              [formControl]="dateBirth" 
              required>
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
              <mat-icon>cake</mat-icon>

              <mat-error *ngIf="dateBirth.hasError('required')">
                {{ $.errors.inputs.general.REQUIRED }}
              </mat-error>
              <mat-error *ngIf="dateBirth.hasError('server-error')">
                {{ this.serverInputsErrors['personal.dateBirth'] }}
              </mat-error>
            </mat-form-field>
          </mat-grid-tile>
          
          <mat-grid-tile>
            <mat-form-field *ngIf="personal.get('telephoneNumber') as tel">
              <mat-label>{{ $.form.inputs.TELEPHONE_NUMBER }}</mat-label>
              <input 
              id="telephoneNumber"
              type="tel" 
              matInput 
              [formControl]="tel">
              <mat-icon>local_phone</mat-icon>

              <mat-error *ngIf="tel.hasError('required')">
                {{ $.errors.inputs.general.REQUIRED }}
              </mat-error>
              <mat-error *ngIf="tel.hasError('server-error')">
                {{ this.serverInputsErrors['personal.telephoneNumber'] }}
              </mat-error>
            </mat-form-field>
          </mat-grid-tile>
        </mat-grid-list>

        <div>
          <button mat-button (click)="onCancel.emit()" class="cancelButton">{{ $.form.controls.CANCEL }}</button>
          <button mat-button matStepperPrevious>{{ $.form.controls.BACK }}</button>
          <button mat-button matStepperNext class="nextButton">{{ $.form.controls.NEXT }}</button>
        </div>
      </form>
    </mat-step>

    <mat-step [label]="$.form.steps.ADDITIONAL" [stepControl]="form.get('additional')">
      <form formGroupName="additional">
        <mat-grid-list cols="1" rowHeight="6rem">
          <mat-grid-tile>
            <mat-form-field>
          <mat-label>{{ $.form.inputs.SKILL_LEVEL }}</mat-label>
          <mat-select formControlName="skillLevel" id="skillLevel">
            <mat-option *ngFor="let lvl of skillLevelPossibleValues" 
            [value]="lvl">{{lvl}}</mat-option>
          </mat-select>
            </mat-form-field>
          </mat-grid-tile>
        </mat-grid-list>

        <div>
          <button mat-button (click)="onCancel.emit()" class="cancelButton">{{ $.form.controls.CANCEL }}</button>
          <button mat-button matStepperPrevious>{{ $.form.controls.BACK }}</button>
          <button mat-button (click)="register()" id="registerButton">{{ $.form.controls.REGISTER }}</button>
        </div>
      </form>
    </mat-step>

  </mat-vertical-stepper>
  
</div>